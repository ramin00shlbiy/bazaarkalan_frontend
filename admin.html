<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت - فروشگاه علی کرمی</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* استایل‌ها مانند قبل */
    </style>
</head>
<body>
    <!-- محتوای پنل مدیریت مانند قبل -->
    
    <script>
        // بارگذاری سفارشات از localStorage
        function loadOrders() {
            const ordersContainer = document.getElementById('ordersContainer');
            const totalOrders = document.getElementById('totalOrders');
            const pendingOrders = document.getElementById('pendingOrders');
            const completedOrders = document.getElementById('completedOrders');
            
            // دریافت سفارشات از localStorage
            const orders = JSON.parse(localStorage.getItem('shop_orders')) || [];
            
            // آمار
            const total = orders.length;
            const pending = orders.filter(order => order.status === 'pending').length;
            const completed = orders.filter(order => order.status === 'completed').length;
            
            totalOrders.textContent = total;
            pendingOrders.textContent = pending;
            completedOrders.textContent = completed;
            
            // نمایش سفارشات
            if (orders.length === 0) {
                ordersContainer.innerHTML = `
                    <div class="no-orders">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <p>هیچ سفارشی ثبت نشده است</p>
                    </div>
                `;
                return;
            }
            
            ordersContainer.innerHTML = '';
            
            // نمایش سفارشات به ترتیب جدیدترین به قدیمی‌ترین
            orders.reverse().forEach((order, index) => {
                let orderItems = '';
                order.items.forEach(item => {
                    orderItems += `${item.name} - ${item.price} افغانی<br>`;
                });
                
                ordersContainer.innerHTML += `
                    <div class="order-item">
                        <div class="order-header">
                            <span class="order-number">${order.id}</span>
                            <span class="order-date">${order.date}</span>
                        </div>
                        <div class="order-details">
                            <strong>مشتری:</strong> ${order.customer.name}<br>
                            <strong>تلفن:</strong> ${order.customer.phone}<br>
                            <strong>آدرس:</strong> ${order.customer.address}<br>
                            <strong>محصولات:</strong><br>${orderItems}
                            <strong>مجموع:</strong> ${order.total} افغانی
                        </div>
                        <div class="order-actions">
                            <button class="action-btn btn-complete" onclick="completeOrder(${orders.length - 1 - index})">
                                ${order.status === 'completed' ? 'تکمیل شده' : 'علامت به عنوان تکمیل شده'}
                            </button>
                            <button class="action-btn btn-delete" onclick="deleteOrder(${orders.length - 1 - index})">حذف</button>
                        </div>
                    </div>
                `;
            });
        }
        
        function completeOrder(index) {
            const orders = JSON.parse(localStorage.getItem('shop_orders')) || [];
            orders[index].status = 'completed';
            localStorage.setItem('shop_orders', JSON.stringify(orders));
            loadOrders();
            alert('سفارش به عنوان تکمیل شده علامت گذاری شد');
        }
        
        function deleteOrder(index) {
            if (confirm('آیا از حذف این سفارش مطمئن هستید؟')) {
                const orders = JSON.parse(localStorage.getItem('shop_orders')) || [];
                orders.splice(index, 1);
                localStorage.setItem('shop_orders', JSON.stringify(orders));
                loadOrders();
                alert('سفارش حذف شد');
            }
        }
        
        // راه‌اندازی اولیه و رفرش خودکار هر 10 ثانیه
        document.addEventListener('DOMContentLoaded', function() {
            loadOrders();
            
            // رفرش خودکار هر 10 ثانیه
            setInterval(loadOrders, 10000);
            
            // دکمه رفرش دستی
            document.getElementById('refreshBtn').addEventListener('click', loadOrders);
        });
    </script>
</body>
</html>
<div class="admin-header">
    <h1 class="admin-title">پنل مدیریت فروشگاه</h1>
    <p>مدیریت سفارشات و موجودی</p>
    <button id="refreshBtn" style="background: #3498db; color: white; border: none; padding: 10px 15px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
        <i class="fas fa-sync-alt"></i> بروزرسانی
    </button>
</div>
