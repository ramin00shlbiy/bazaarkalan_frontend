<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فروشگاه علی کرمی</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* استایل‌ها مانند قبل */
    </style>
</head>
<body>
    <!-- محتوای صفحه مانند قبل -->
    
    <script>
        // مدیریت سبد خرید
        let cart = [];
        let cartCount = 0;
        
        function addToCart(name, price) {
            cart.push({ name, price });
            cartCount++;
            updateCart();
            openCart();
            
            // نمایش اعلان
            alert(`${name} به سبد خرید اضافه شد`);
        }
        
        function updateCart() {
            // کد مانند قبل
        }
        
        function openCart() {
            // کد مانند قبل
        }
        
        function closeCart() {
            // کد مانند قبل
        }
        
        function checkout() {
            // کد مانند قبل
        }
        
        // مدیریت فرم سفارش
        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            
            // تولید شماره سفارش
            const orderNumber = 'ORD' + Math.floor(1000 + Math.random() * 9000);
            document.getElementById('orderNumber').textContent = orderNumber;
            
            // ذخیره سفارش در localStorage
            const newOrder = {
                id: orderNumber,
                date: new Date().toLocaleString('fa-IR'),
                customer: { name, phone, address },
                items: [...cart],
                total: cart.reduce((sum, item) => sum + item.price, 0),
                status: 'pending'
            };
            
            // دریافت سفارشات موجود از localStorage
            const existingOrders = JSON.parse(localStorage.getItem('shop_orders')) || [];
            
            // افزودن سفارش جدید
            existingOrders.push(newOrder);
            
            // ذخیره در localStorage
            localStorage.setItem('shop_orders', JSON.stringify(existingOrders));
            
            // نمایش وضعیت سفارش
            document.getElementById('orderForm').style.display = 'none';
            document.getElementById('orderStatus').style.display = 'block';
            
            // پاک کردن سبد خرید
            cart = [];
            cartCount = 0;
            updateCart();
            
            alert(`سفارش شما با شماره ${orderNumber} ثبت شد.`);
        });
        
        // راه‌اندازی اولیه
        document.addEventListener('DOMContentLoaded', function() {
            updateCart();
        });
    </script>
</body>
</html>
