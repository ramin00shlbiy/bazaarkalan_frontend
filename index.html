<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فروشگاه علی کرمی</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* استایل‌ها مانند قبل */
    </style>
</head>
<body>
    <!-- محتوای صفحه مانند قبل -->

    <script>
        // مدیریت سبد خرید مانند قبل

        // مدیریت فرم سفارش
        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            
            // تولید شماره سفارش
            const orderNumber = 'ORD' + Math.floor(1000 + Math.random() * 9000);
            document.getElementById('orderNumber').textContent = orderNumber;
            
            // ارسال داده به Netlify Forms
            const formData = new FormData();
            formData.append('order-number', orderNumber);
            formData.append('name', name);
            formData.append('phone', phone);
            formData.append('address', address);
            formData.append('items', JSON.stringify(cart));
            formData.append('total', cart.reduce((sum, item) => sum + item.price, 0));
            formData.append('status', 'pending');
            
            fetch('/', {
                method: 'POST',
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams(formData).toString()
            }).then(() => {
                // نمایش وضعیت سفارش
                document.getElementById('orderForm').style.display = 'none';
                document.getElementById('orderStatus').style.display = 'block';
                
                // پاک کردن سبد خرید
                cart = [];
                cartCount = 0;
                updateCart();
            }).catch(error => alert('خطا در ارسال سفارش. لطفاً دوباره تلاش کنید.'));
        });
    </script>
</body>
</html>

<form name="orders" netlify netlify-honeypot="bot-field" hidden>
    <input type="text" name="order-number">
    <input type="text" name="name">
    <input type="tel" name="phone">
    <textarea name="address"></textarea>
    <input type="text" name="items">
    <input type="number" name="total">
    <input type="text" name="status">
</form>
